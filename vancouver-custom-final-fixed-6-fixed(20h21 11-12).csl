<?xml version="1.0" encoding="utf-8"?>
<style xmlns="http://purl.org/net/xbiblio/csl" version="1.0"
    class="in-text" default-locale="en-US" demote-non-dropping-particle="sort-only">

  <info>
    <title>Vancouver Custom - final (supports literal authors for VN names)</title>
    <id>http://www.zotero.org/styles/vancouver-custom-final-6</id>
    <link href="http://www.zotero.org/styles/vancouver-custom-final-6" rel="self"/>
    <link href="http://www.zotero.org/styles/vancouver" rel="template"/>
    <author><name>Modified by ChatGPT</name></author>
    <category citation-format="numeric"/>
    <category field="medicine"/>
    <summary>Custom Vancouver: author (year), "title", books &amp; theses italic, edition after book title, comma separators. For Vietnamese authors, enter full name in the single-field author entry (literal) so CSL will print it verbatim; for non-Vietnamese, enter family/given to allow initials.</summary>
    <updated>2025-12-11T13:14:19.407553Z</updated>
  </info>

  <!-- In-text citation format -->
  <citation>
    <sort>
      <key variable="citation-number"/>
    </sort>
    <layout delimiter="],[" prefix="[" suffix="]">
      <text variable="citation-number"/>
    </layout>
  </citation>

  <!-- Author macro:
       Prefer parsed names if available (will render as Family GivenInitials)
       If the record uses a literal name (single-field author), output it verbatim.
       To ensure this works: in Mendeley enter Vietnamese names into the "Last name" field
       as a single literal (or use single-field entry) so the parser treats it as literal.
  -->
  <macro name="author">
    <choose>
      <!-- If literal author exists, use literal (verbatim) -->
      <if variable="author" match="all">
        <!-- Use names element which will render parsed names; fallback handled by substitute -->
        <names variable="author">
          <name name-as-sort-order="all" form="short" initialize-with="." delimiter=", " sort-separator=" " />
          <label form="short" prefix=", "/>
          <substitute>
            <!-- If parsing fails, output literal string of authors -->
            <text variable="author"/>
          </substitute>
        </names>
      </if>
      <else>
        <text variable="author"/>
      </else>
    </choose>
  </macro>

  <macro name="year-paren">
    <date variable="issued">
      <date-part name="year" prefix="(" suffix=")"/>
    </date>
  </macro>

  <macro name="title-quoted">
    <text variable="title" prefix="&quot;" suffix="&quot;"/>
  </macro>

  <macro name="title-italic">
    <text variable="title" font-style="italic"/>
  </macro>

  <macro name="edition">
    <choose>
      <if is-numeric="edition">
        <number variable="edition" form="ordinal" suffix=" ed."/>
      </if>
      <else>
        <text variable="edition"/>
      </else>
    </choose>
  </macro>

  <macro name="pages">
    <choose>
      <if variable="page">
        <text variable="page"/>
      </if>
    </choose>
  </macro>

  <macro name="journal">
    <group delimiter=", ">
      <text variable="container-title" font-style="italic"/>
      <group>
        <text variable="volume"/>
        <text variable="issue" prefix="(" suffix=")"/>
      </group>
      <text macro="pages"/>
    </group>
  </macro>

  <macro name="book">
    <group delimiter=", ">
      <text macro="title-italic"/>
      <text macro="edition"/>
      <text variable="publisher"/>
      <text variable="publisher-place"/>
    </group>
  </macro>

  <macro name="chapter">
    <group delimiter=", ">
      <text macro="title-quoted"/>
      <group delimiter=" ">
        <text value="In:"/>
        <names variable="editor">
          <name initialize-with="." delimiter=", " sort-separator=" " />
        </names>
      </group>
      <text variable="container-title" font-style="italic"/>
      <text macro="edition"/>
      <text variable="publisher"/>
      <text variable="publisher-place"/>
      <text macro="pages"/>
    </group>
  </macro>

  <macro name="thesis">
    <group delimiter=", ">
      <text macro="title-italic"/>
      <text variable="publisher"/>
      <text variable="publisher-place"/>
      <text macro="pages"/>
    </group>
  </macro>

  <macro name="web">
    <group delimiter=", ">
      <text macro="title-quoted"/>
      <text value="[online]"/>
      <group delimiter=" ">
        <text value="Available at:"/>
        <text variable="URL"/>
      </group>
      <group>
        <text value="[Accessed "/>
        <date variable="accessed">
          <date-part name="day" suffix=" "/>
          <date-part name="month" form="long" suffix=" "/>
          <date-part name="year"/>
        </date>
        <text value="]"/>
      </group>
    </group>
  </macro>

  <macro name="locators">
    <choose>
      <if type="article-journal">
        <text macro="journal"/>
      </if>
      <else-if type="chapter paper-conference">
        <text macro="chapter"/>
      </else-if>
      <else-if type="book">
        <text macro="book"/>
      </else-if>
      <else-if type="thesis report">
        <text macro="thesis"/>
      </else-if>
      <else-if type="webpage post post-weblog">
        <text macro="web"/>
      </else-if>
      <else>
        <text variable="publisher"/>
      </else>
    </choose>
  </macro>

  <!-- Override et-al term to remove final period and ensure no comma before et al -->
  <terms>
    <term name="et-al">et al</term>
  </terms>

  <bibliography et-al-min="4" et-al-use-first="3" hanging-indent="true" second-field-align="flush">
    <sort>
      <key variable="citation-number"/>
    </sort>
    <layout>
      <text variable="citation-number" suffix=". "/>
      <text macro="author"/>
      <text macro="year-paren" prefix=" "/>
      <choose>
        <if type="article-journal chapter paper-conference webpage post post-weblog">
          <text macro="title-quoted" prefix=", "/>
        </if>
        <else-if type="book thesis report">
          <text macro="title-italic" prefix=", "/>
        </else-if>
        <else>
          <text macro="title-quoted" prefix=", "/>
        </else>
      </choose>
      <text macro="locators" prefix=", "/>
      <text value="."/>
    </layout>
  </bibliography>

</style>
